import gensim
from gensim import models
from gensim import corpora
from pprint import pprint
from gensim.utils import simple_preprocess
from smart_open import smart_open
import os
import numpy as np
from nltk.corpus import stopwords
import re
import logging
import gensim.downloader as api
from gensim.utils import simple_preprocess, lemmatize
from gensim.models import LdaModel, LdaMulticore
import gensim.downloader as api
import os 
import re
#import nltk
#from nltk.tokenize import word_tokenize,sent_tokenize

logging.basicConfig(format='%(asctime)s : %(levelname)s : %(message)s')
logging.root.setLevel(level=logging.INFO)
stop_words = stopwords.words('english')
stop_words = stop_words + ['com', 'edu', 'subject', 'lines', 'organization', 'would', 'article', 'could']


count = 0
save_dir = '/mnt/c/Documents and Settings/imasi/Desktop/Testingfor 4480/newwords/'
pattern = "[a-zA-Z0-9/]*L[^ :;'()][a-zA-Z/0-9]*"


p ="[^ :a-zA-Z()]*[a-zA-Z0-9/]*L[^ :;'()][a-zA-Z/0-9]*[;$]"

pattern = "[^ ;'.$:\]\[()]*[a-zA-Z/0-9]*;"

#pattern = "[^0-9<>\{\}()][a-zA-Z]+"

pattern = '[a-zA-Z0-9/+]+\/[a-zA-Z0-9+/]+'
#G:\4480\maldozer_dataset\extract

#rootDir = '/mnt/c/Documents and Settings/imasi/Desktop/Testingfor 4480/text/'


rootDir = '/mnt/g/4480/maldozer_dataset/extract/'
for dirName, subdirList, fileList in os.walk(rootDir, topdown=False):
   # print('Found directory: %s' % dirName)
    for fname in fileList:
        print('Found directory: %s' % fname)
        holder = set()
        

        completeName = os.path.join(rootDir, fname)
        with open(completeName, errors='ignore') as fp:
            line = fp.readline()
            cnt = 1
            while line:
                if(cnt >= 3):
                    #if (line[:1] != " "):
                        nL = re.findall(pattern,line)
                        #print(nL)
                        
                       
                        if nL:
                            nL = " ".join(nL)
                            nL = re.sub('[;]','',nL)
                            #print(nL)
                            holder.update(nL.split())

                    #     if count == 0:
                    #         newline = line[54:]
                    #         count +=1
                    #     else:
                    #         newline = line[54:-9]
                    #     if newline:
                    #         holder.update(newline.split())
                        
                    # else:
                    #     newline = line[23:]
                    #     if newline:
                    #         holder.update(newline.split())
                    #     count = 0


                line = fp.readline()
                #print(cnt)
                cnt += 1
        #print(holder)


        data = list(holder)
        #data = [re.sub('[/.:,;()]',' ',sent.lower()) for sent in data]
        #print(data)


        print("FINSED READ AND STARTED FIXING")
        for elements in data:
    #print(elements[0] == "-")
    
            if elements[0] == '-' or elements[0] == '+' or elements[0] == 'v' or elements[0] == '#':
       # print(elements)
                data.remove(elements)
        
        
        
        
        completeName = os.path.join(save_dir, fname[:-4]+"wordlist.txt")
       # print(completeName)
        writer = open(completeName,"w")
        for elements in data:
            writer.write(elements + " ")

        writer.close()




























#holder = set()
#print(type(holder))

# with open(filepath, errors='ignore') as fp:
#     line = fp.readline()
#     cnt = 1
#     while line:
        
#         if(line[:1] != " "):
        
#             sentence = re.sub('[{}]','', line[54:])
#             sen1 = re.sub('[,.;:/"\'()]',' ',sentence)
      

#             if (len(sen1)>0):
#                 if(sen1[1] == ']'):
#                     sen2 = sen1[3:]
#                     y = set(sen2.split())
#                     holder.update(y)
                    
#                 else:
               
#                     x = set(sen1.split())
                  
#                     holder.update(x)
#         line = fp.readline()
#         cnt += 1



# newSet = list(holder)
# #print(len(newSet))
# for elements in newSet:
#     #print(elements[0] == "-")
    
#     if elements[0] == '-' or elements[0] == '+' or elements[0] == 'v' or elements[0] == '#':
#        # print(elements)
#         newSet.remove(elements)


# #for elements in newSet:
# writer = open(filepath[:-4]+"wordlist.txt","w")

# for elements in newSet:
#     writer.write(elements + " ")

# writer.close()